<tal:linkfield
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    i18n:domain="collective.tablepage">


<label class="subFieldLabel"
       tal:attributes="for view/configuration/id"
       tal:content="view/configuration/label">A good field</label>
<span class="fieldRequired" title="Required"
      tal:condition="view/options/required"
      i18n:domain="plone"
      i18n:attributes="title title_required;"
      i18n:translate="label_required">(Required)</span>
<div class="formHelp" tal:content="view/configuration/description">
    Help filling me
</div>

<div class="field subField">
    <label tal:attributes="for string:external_${view/configuration/id}"
           i18n:translate="">URL</label>
    <span class="fieldRequired" title="Required"
          tal:condition="view/options/required|nothing"
          i18n:domain="plone"
          i18n:attributes="title title_required;"
          i18n:translate="label_required">(Required)</span>
    <div class="formHelp" i18n:translate="help_external_link">
        Provide a link to a know resource. This will be ignored if you use the \"Internal link\" below 
    </div>
    <input type="url" size="50" placeholder="http://"
           tal:define="fromreq python:request.get('external_' + view.configuration['id']);"
           tal:attributes="id string:external_${view/configuration/id};
                           name string:external_${view/configuration/id};
                           value python:fromreq or options.get('external_url') or nothing;" />
</div>
<div class="field subField"
     tal:define="startup_directory view/getStartupDirectory;
                 helper python:context.restrictedTraverse('refbrowserhelper', nothing);
                 at_url helper/getAtURL|nothing;
                 ref_document view/getReferencedDocument">
    <label tal:attributes="for string:command_internal_${view/configuration/id}"
           i18n:translate="">Internal link</label>
    <div class="formHelp" i18n:translate="help_internal_link">
        As an alternative to the \"URL\" above you can provide a link to an internal document. This will override
        any absolute URL you put above.  
    </div>
    <input type="text"
          tal:define="portal_url nocall:context/portal_url;
                      portal_url string:${portal_url/getPortalPath};
                      href string:$portal_url/@@getVocabulary?name=plone.app.vocabularies.Catalog&amp;field=relatedItems;
                      fromreq python: 'data' in options and options.get('data')"
          tal:attributes="id string:internal_${view/configuration/id};
                          name string:internal_${view/configuration/id};
                          href href;
                          value fromreq"
          class="pat-relateditems"
          data-pat-relateditems='{"maximumSelectionSize":"1", "vocabularyUrl": "${href}", "rootUrl": "/"}' />

</div>

</tal:linkfield>